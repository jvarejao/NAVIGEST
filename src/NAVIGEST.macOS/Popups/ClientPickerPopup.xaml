<?xml version="1.0" encoding="utf-8" ?>
<toolkit:Popup xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
               xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
               xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
               xmlns:models="clr-namespace:NAVIGEST.macOS.Models"
               x:Class="NAVIGEST.macOS.Popups.ClientPickerPopup"
               Color="Transparent"
               CanBeDismissedByTappingOutsideOfPopup="True">
    
    <Border StrokeShape="RoundRectangle 12" 
            BackgroundColor="{DynamicResource PageBackgroundColor}"
            WidthRequest="500"
            HeightRequest="600"
            Padding="20">
        
        <Grid RowDefinitions="Auto, Auto, *">
            <Label Text="Selecionar Cliente" FontSize="18" FontAttributes="Bold" Margin="0,0,0,10"/>
            
            <SearchBar Grid.Row="1" 
                       Placeholder="Pesquisar cliente..." 
                       TextChanged="OnSearchTextChanged"
                       Margin="0,0,0,10"/>
            
            <CollectionView Grid.Row="2" 
                            x:Name="ClientsList" 
                            SelectionMode="Single"
                            SelectionChanged="OnSelectionChanged">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:Cliente">
                        <Border StrokeThickness="0" Padding="10" Margin="0,2" BackgroundColor="{DynamicResource CardBackgroundColor}">
                            <VerticalStackLayout>
                                <Label Text="{Binding CLINOME}" FontAttributes="Bold" TextColor="{DynamicResource BodyTextColor}"/>
                                <Label Text="{Binding CLICODIGO}" FontSize="12" TextColor="Gray"/>
                            </VerticalStackLayout>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
            
            <ActivityIndicator Grid.Row="2" x:Name="LoadingIndicator" IsRunning="False" HorizontalOptions="Center" VerticalOptions="Center"/>
        </Grid>
    </Border>
</toolkit:Popup>